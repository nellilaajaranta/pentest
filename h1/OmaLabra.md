# h1 OmaLabra

Tero Karvisen [Tunkeutumistestaus 2023-kurssin](https://terokarvinen.com/2023/tunkeutumistestaus-2023-kevat/) h1-tehtäväraporttini.

## x) Lue ja tiivistä.

Tein tiivistelmän Darknet Diaries-podcastin jaksosta [11: Strictly Confidential](https://darknetdiaries.com/transcript/11/).

## a) Asenna Kali virtuaalikoneeseen

Latasin [Kali Linux](https://www.kali.org/get-kali/#kali-installer-images) Kali Installerin. 
Tämän jälkeen loin Virtualboxiin uuden virtuaalikoneen ja lisäsin lataamani Kali installerin virtuaalikoneen disk imageksi ja käynnistin virtuaalikoneen. 
Asennus oli yksinkertainen next-next tyylinen eikä vaatinut erityisiä toimenpiteitä.

## b) Asenna Metasploitable 2 virtuaalikoneeseen

Latasin [Metasploitable2](https://sourceforge.net/projects/metasploitable/) koneelleni. Tämän jälkeen loin uuden virtuaalikoneen VirtualBoxiin, 
jonka jälkeen menin kyseisen virtuaalikoneen storage-asetuksiin ja lisäsin lataamani Metasplotable2-vmdk-tiedoston virtuaalikoneen levyihin.

kuva

## c) Tee koneille virtuaaliverkko, jossa Kali saa yhteyden Internettiin, mutta sen voi laittaa pois päältä & Kalin ja Metasploitablen välillä on host-only network, niin että porttiskannatessa ym. koneet on eristetty intenetistä, mutta ne saavat yhteyden toisiinsa

Avasin VirtualBoxin Network Managerin ja loin uuden Host-only adapterin Create-painikkeesta Host-only välilehdellä. Sen jälkeen enabloin DHCP serverin kys. adapterille ja valitsin että adapteri konfiguroidaan automaattisesti.

kuva

Kalin verkko-asetuksista kävin asettamassa Adapter 1 NAT-verkoksi sekä Adapter 2 juuri luomaani Host-only verkkoon. Tällöin Kalin saa halutessaan yhdistettyä internetiin yhdistämällä sen NAT-verkkoon.

kali kuva 

Metasploitable2 verkko-asetuksista kävin määrittämässä Adapter 1 juuri luomani Host-only verkon, jolloin Kali ja Metasploitable2 voivat löytää toisensa tämän verkon kautta. Metasploitable2-koneen ei ole tarkoitus yhdistää verkkoon.

kuva

Käynnistin Kalin ja katsoin että se on yhteydessä NAT-verkkoon. Kali ei kuitenkaan saanut yhteyttä internetiin. Löysin korjauksen [VirtualBoxin foorumilta](https://forums.virtualbox.org/viewtopic.php?t=97599),
jossa yhden vastauksen mukaan komennolla `nmtui` saa aktivoitua NAT:in yhteyden. Komento avaa seuraavan näkymän:

nmtu

nmtui

yhteyden aktivoinnin jälkeen NAT-verkon internet-yhteys alkoi toimia. 

kuva

Tämän jälkeen laitoin NAT-yhteyden pois VirtualBoxin network-asetuksista klikkaamalla "cable connected" ruksin pois.

kuva

Yhdistin Kalin Host-only verkkoon. Kokeilin vielä ettei se varmasti ole yhteydessä internetiin pingaamalla googlea:

kuva

Tämän jälkeen käynnistin Metasploitable2 koneen ja kirjauduin siihe sisään. Kokeilin myös sillä ettei se ole yhteydessä verkkoon pingaamalla googlea:

kuva

Sitten tarkistin Metasploitable2 koneen ip-osoitteen ifconfig-komennolla ja pingasin Metasploitablea Kalilla varmistaakseni, että koneet löytävät toisnsa host-only verkossa.

kuva

## d) Etsi Metasploitable porttiskannaamalla (db_nmap -sn). Tarkista selaimella, että löysit oikean IP:n - Metasploitablen etusivulla lukee Metasploitable.

Avasin Kalin komentorivillä mfsconsolen.

kuva

Sitten ajoin seuraavan komennon, jolla skannaan nmap-työkalulla haluamani verkon hostit:

`db_nmap -sn 192.168.115.0/24`

