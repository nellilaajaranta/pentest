# H h3 The Box

Tero Karvisen [Tunkeutumistestaus 2023-kurssin](https://terokarvinen.com/2023/tunkeutumistestaus-2023-kevat/) h3-tehtäväraporttini.

## x) Katso ja tiivistä (Tässä x-alakohdassa ei tarvitse tehdä testejä tietokoneella, vain lukeminen tai kuunteleminen ja tiivistelmä riittää. Tiivistämiseen riittää muutama ranskalainen viiva.)

tiivistelmä videosta [IppSec-videosta HackTheBox - Knife](https://www.youtube.com/watch?v=93JnRTF5sQM)

## a) We like to shop. Ratkaise Portswigger Academyn "Lab: SQL injection vulnerability in WHERE clause allowing retrieval of hidden data". (Tee tarvittaessa tunnus Portswigger Academyyn).

Labrassa tuli saada verkkokaupan piilotetut tuotteet esille SQL injektion avulla käyttäen hyväksi tuotefiltterin haavoittuvuutta. Käytin tähän työkalunaa ZAP:ia.

Avasin PortSwiggerin labran sivun ja laitoin ZAP:n "set break on all requests and responses" -vihreän painikkeen päälle keskeyttääkseni liikenteen. Sitten painoin satunnaista verkkokaupan tutekategoriafiltteriä saadakseni sen verkko-osoitteen esille ZAP:iin voidakseni muokata sitä. Tein sen perään seuraavan muutoksen:

`GET https://web-security-academy.net/filter?category=Clothing%2c+shoes+and+accessories'+OR+1+=1-- HTTP/1.1`

![kysely](https://github.com/nellilaajaranta/pentest/blob/main/pictures/h3/PortS_1.PNG)

+merkit siksi, että verkko-osoitteessa ei voi olla välejä. Lähetin tämän muokatun kyselyn eteenpäin ZAP:ssa, ja tämä injektio toimi eli nerkkokauppa näytti uusia, piilotettuja tuotteita:

![tulos](https://github.com/nellilaajaranta/pentest/blob/main/pictures/h3/Ports_2.PNG)

## b) HTB. Tee HackTheBox.com tunnus. Avaa OpenVPN-yhteys "Starting Point" verkkoon. Estä tunnelin ulkopuolinen liikenne eli liikenne oikeaan Internettiin (vinkit alla). Testaa, että normaali Internet-liikenteesi on estetty.

Loin tunnuksen HackTheBoxiin ja klikkasin sivun oikealla olevaa painiketta "Connect to HTB".

![connection](https://github.com/nellilaajaranta/pentest/blob/main/pictures/h3/HTB1.jpg)

Tämän jälkeen valitsin "OpenVPN".

![OpenVPN](https://github.com/nellilaajaranta/pentest/blob/main/pictures/h3/HTB2.jpg)

Jätin oletusasetukset seuraavasta näkymästä ja latasin OpenVPN:n tiedoston.

![conf](https://github.com/nellilaajaranta/pentest/blob/main/pictures/h3/HTB3.jpg)

Seuraavaksi etenin [Tero Karvisen ohjetta/vihjettä](https://terokarvinen.com/2023/tunkeutumistestaus-2023-kevat/) (h3 The Box-tehtävänannon alla) OpenVPN:n käyttöönottoa varten.

Avasin terminaalin kautta network connections-näkymän seuraavalla komennolla:

`nm-connection-editor`

Verkkoasetuksissa loin uuden yhteysmuodon +-merkistä, ja valitsin avautuvan näkymän pudotusvalikosta "import a saved VPN configuration…" ja painoin create:

![network](https://github.com/nellilaajaranta/pentest/blob/main/pictures/h3/HTB4.jpg)

Sitten valitsin juuri lataamani OpenVPN-tiedoston, jätin sen oletusasetukset päälle ja painoin save. Tämän jälkeen otin tämän juuri luodun yhteyden käyttöön avaamalla Kalin oikean ylänurkan verkkoasetuksista "VPN Connections" alta tämän VPN-yhteyden.

![vpn](https://github.com/nellilaajaranta/pentest/blob/main/pictures/h3/HTB5.jpg)

Yritin päivittää HackTheBoxin sivua tämän jälkeen, mutta sivu jäi jumiin lataamaan ja antoi "network error" varoituksia enkä pystynyt tehdä mitään. Laitoin VPN-yhteyden pois päältä ja päivitin sivun, jolloin HTB ilmoitti että olisin yhdistäneenä siihen sekä pääsin nyt tekemään HackTheBoxin taskit + spawn machine , mutta verkkoyhteyteni oli yhä tallella eli yhteys jäi jonkinlaiseen välitilaan. Kokeilin vaihtaa serveriä EU StartingPoint2, joka toimi, mutta ulkopuolinen liikenne ei ollut estetty. Päätin kuitenkin jaktaa tehtävien tekoa.

![connection](https://github.com/nellilaajaranta/pentest/blob/main/pictures/h3/HTB7.jpg)

## c) Meow. Käynnistä "Starting point": "Meow". (Spawn machine). Tallenna ruutukaappaus sivusta, jossa näkyy koneen osoite ja tunkeutumistehtäviä. Porttiskannaa kone ja analysoi tulokset. Suorita HTB:n antamat tehtävät. Raportoi normaalisti, "Starting point" -koneista saa julkaista läpikävelyohjeita.

Käynnistin koneen "spawn machine" painikkeesta. Se käynnistyi:

![meow](https://github.com/nellilaajaranta/pentest/blob/main/pictures/h3/HTB8.jpg)

Task-tehtävät olivat hyvin helppoja perusteita, joten en avaa niitä enempää kuvien lisäksi.

![task1](https://github.com/nellilaajaranta/pentest/blob/main/pictures/h3/HTB8.jpg)

![task2](https://github.com/nellilaajaranta/pentest/blob/main/pictures/h3/HTB_meow3.jpg)

![Task3](https://github.com/nellilaajaranta/pentest/blob/main/pictures/h3/HTB_meow4.jpg)

![Task4](https://github.com/nellilaajaranta/pentest/blob/main/pictures/h3/HTB_meow5.jpg)

![Task5](https://github.com/nellilaajaranta/pentest/blob/main/pictures/h3/HTB_meow6.jpg)

![Task6](https://github.com/nellilaajaranta/pentest/blob/main/pictures/h3/HTB_meow7.jpg)

![Task7](https://github.com/nellilaajaranta/pentest/blob/main/pictures/h3/HTB_meow7.jpg)

![Task8](https://github.com/nellilaajaranta/pentest/blob/main/pictures/h3/HTB_meow9.jpg)

Tunnel interfacen lyhenteen sain selville selvitellessäni aiempaa VPN-ongelmaani.

Seuraavaksi porttiskannasin meow-koneen nmapilla seuraavalla komennolla:

`Nmap -sV 10.129.133.84`

-sV siksi, että näen palveluiden versiot. Tulos:

![nmap](https://github.com/nellilaajaranta/pentest/blob/main/pictures/h3/HTB_meow_nmapscan.jpg)

Kuvasta näkyy, että koneessa on auki TCP-portti 23, joka on telnetin portti. Tämän johdosta kokeilin telnet-yhteyttä siihen. Perustuen Task 8-tehtävän vastaukseen root, kokeilin sitä kirjautumiseen, joka onnistui:

![meow telnet](https://github.com/nellilaajaranta/pentest/blob/main/pictures/h3/HTB_meow_telnet.jpg)

Root flagin saamiseksi en oikein tajunnut mistä aloittaa, joten menin lukemaan meow:sta tarjotun walkthrough:n, jonka saa avattua target machinen ip-osoitteen alta. Selvisi että `ls` komennolla saa näkyviin "flag.txt"-tiedoston, jossa root flag on eli tehtävä olikin hyvin yksinkertainen.

![meow ls](https://github.com/nellilaajaranta/pentest/blob/main/pictures/h3/HTB_meow_ls.jpg)

Seuraavaksi katsoin cat-komennolla tiedoston sisällön:

`cat flag.txt`

![meow cat](https://github.com/nellilaajaranta/pentest/blob/main/pictures/h3/HTB_meow_flag.jpg)

Kopioin tämän submit flag-kenttään:

![root flag](https://github.com/nellilaajaranta/pentest/blob/main/pictures/h3/HTB_meow_flag2.jpg)

Meow suoritettu:

![meow done](https://github.com/nellilaajaranta/pentest/blob/main/pictures/h3/HTB_meow_done.jpg)



## d) Fawn. Ratkaise Fawn. (HTB Starting point)



## e) Dancing. Ratkaise Dancing. (HTB Starting point)
